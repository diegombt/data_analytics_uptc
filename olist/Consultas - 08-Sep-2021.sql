------------------------------------------------------------------------------------------------------------
-- Tabla de ordenes
------------------------------------------------------------------------------------------------------------
select *
  from orders o
 limit 100;

------------------------------------------------------------------------------------------------------------
-- Tabla de productos
------------------------------------------------------------------------------------------------------------
select *
  from products p
 limit 100;

------------------------------------------------------------------------------------------------------------
-- Tabla de ordenes e items
------------------------------------------------------------------------------------------------------------
select order_id, product_id, price, sum(price) as product_price, count(*) as units
  from order_items oi
 group by order_id, product_id, price
having count(*) > 1 and sum(price) > 100 -- Having - Restricciones sobre las agregaciones
 limit 100;

------------------------------------------------------------------------------------------------------------
-- Tabla de pagos
------------------------------------------------------------------------------------------------------------
select * -- distinct payment_type
  from order_payments p
 limit 100;

 -- Pagos puede ser diferente de invoices → factura, valor del envio, descuentos, recargos, promociones

------------------------------------------------------------------------------------------------------------
-- Tabla de categorias
------------------------------------------------------------------------------------------------------------
select *
  from product_category c
 limit 100;

------------------------------------------------------------------------------------------------------------
-- Join / inner join
------------------------------------------------------------------------------------------------------------
select oi.product_id
      ,p.product_id
  from order_items oi
  join products p
    on p.product_id = oi.product_id
 limit 100

------------------------------------------------------------------------------------------------------------
-- left join
------------------------------------------------------------------------------------------------------------
select *
  from order_items oi
  left join products p
    on p.product_id = oi.product_id
 limit 100

------------------------------------------------------------------------------------------------------------
-- Notación grafica de Joins
-- https://blog.jooq.org/say-no-to-venn-diagrams-when-explaining-joins/
------------------------------------------------------------------------------------------------------------